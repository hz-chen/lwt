HEADER_FILES=$(wildcard *.h)
ASM_FILES=$(wildcard *.S)
COMM_FLAGS=-Wall 
PROF_FLAGS=-pg -lc -g
DBG_FLAGS=-g -DDBG 
O_FLAGS=-O3
LIBS=-llwt
main: main.c 
	gcc $^ $(DBG_FLAGS) $(PROF_FLAGS) -o $@ $(LIBS)

exam: $(HEADER_FILES) $(ASM_FILES) exam.c
	gcc $^ $(COMM_FLAGS) $(DBG_FLAGS) -o $@ $(LIBS)

final: $(HEADER_FILES) $(ASM_FILES) exam.c
	gcc $^ $(COMM_FLAGS) -O3 -o $@ $(LIBS)

install:  $(HEADER_FILES) $(ASM_FILES)
	mkdir -p /usr/include/lwt
	cp $^ /usr/include/lwt/
	gcc  $(COMM_FLAGS) -o liblwt.so.1.0 -fPIC $^ -lpthread -shared
	cp liblwt.so.1.0 /usr/lib
	ln -sf /usr/lib/liblwt.so.1.0 /usr/lib/liblwt.so.1
	ln -sf /usr/lib/liblwt.so.1.0 /usr/lib/liblwt.so

uninstall:
	rm -rf /usr/lib/liblwt.so*

clean: 
	rm -rf exam main final *.o 
